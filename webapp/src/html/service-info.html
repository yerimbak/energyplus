<!DOCTYPE html>
<html lang="ko" dir="ltr">
@@include('./include/head.html')
<body>
@@include('./include/skip_navi.html')
<div id="wrap" role="main">

	<!-- Header -->
	<header id="header">
		<div class="inner">
			<a href="#" class="is-back">
				<i class="icon-arrow-left"></i>
				<span class="blind">이전</span>
			</a>
			<div class="has-text-centered">
				<h2 class="title is-3">서비스안내1</h2>
			</div>
		</div>
	</header>
	<!-- // Header -->

	<div id="container" class="fixed-button">
		<!-- Contents -->
		<div id="contents" class="container">
			<div class="service-info inner">
				<h3 class="title">바로주유 사용방법</h3>
				<h4 class="sub-title">바로주유 <strong class="line"><span class="text">사전 설정 방법</span></strong></h4>
				<div class="service-list">
					<ol>
						<li>
							<div class="service-number"><strong>01</strong></div>
							<div class="list-title"><strong>메인<span class="line color-2"><span class="text">‘바로주유 시작’</span></span><br>버튼 선택</strong></div>
							<div class="service-image">
								<img src="/images/phone-01.png" alt="">
							</div>
						</li>
						<li>
							<div class="service-number"><strong>02</strong></div>
							<div class="list-title"><strong>유종 / 주유금액<br>선택</strong></div>
							<div class="service-image">
								<img src="/images/phone-02.png" alt="">
							</div>
						</li>
						<li>
							<div class="service-number"><strong>03</strong></div>
							<div class="list-title"><strong>포인트 / 쿠폰<br>사용설정</strong></div>
							<div class="service-image">
								<img src="/images/phone-03.png" alt="">
							</div>
						</li>
						<li>
							<div class="service-number"><strong>04</strong></div>
							<div class="list-title"><strong>GS&amp;POINT<br>적립카드 선택</strong></div>
							<div class="service-image">
								<img src="/images/phone-04.png" alt="">
							</div>
						</li>
						<li>
							<div class="service-number"><strong>05</strong></div>
							<div class="list-title"><strong>결제 카드<br>등록</strong></div>
							<div class="service-image">
								<img src="/images/phone-05.png" alt="">
							</div>
							<p class="reference">* 결제 카드 등록시 100원<br>결제 승인/취소 1회 발생</p>
						</li>
						<li>
							<div class="service-number"><strong>06</strong></div>
							<div class="list-title"><strong>결제 비밀번호<br>등록</strong></div>
							<div class="service-image">
								<img src="/images/phone-06.png" alt="">
							</div>
							<p class="reference">* 결제 비밀번호는<br>최초 1회 등록</p>
						</li>
					</ol>
				</div>
				<h3 class="title">바로주유 사용 안내</h3>
				<h4 class="sub-title"><strong class="line"><span class="text">셀프 주유 시</span></strong></h4>
				<div class="service-list ty2">
					<ol>
						<li>
							<div class="service-number"><strong>01</strong></div>
							<div class="list-title"><strong>에너지플러스 앱으로<br>주유소 찾기</strong></div>
							<p class="reference">상단 필터 ‘바로주유’<br>선택 후 주유소 검색 </p>
							<div class="service-image">
								<img src="/images/phone-07.png" alt="">
							</div>
						</li>
						<li>
							<div class="service-number"><strong>02</strong></div>
							<div class="list-title"><strong>주유소 도착 후<br>에너지플러스 앱에서<br><span class="line"><span class="text">바로주유  선택</span></span></strong></div>
							<div class="service-image" style="margin-top:17px;">
								<img src="/images/phone-08.png" alt="">
							</div>
						</li>
						<li>
							<div class="service-number"><strong>03</strong></div>
							<div class="list-title"><strong>셀프 주유기<br>화면에서<br><span class="line"><span class="text">바로주유 선택</span></span></strong></div>
							<div class="service-image">
								<img src="/images/phone-09.png" alt="">
							</div>
						</li>
						<li>
							<div class="service-number"><strong>04</strong></div>
							<div class="list-title"><strong>앱에 표시된<br>바코드 스캔<br>또는 주유번호(<em>6자리</em>) 입력</strong></div>
							<div class="service-image">
								<img src="/images/phone-10.png" alt="">
							</div>
						</li>
						<li class="item-one">
							<div class="service-number"><strong>05</strong></div>
							<div class="list-title"><strong>주문확인 후 주유</strong></div>
							<div class="service-image" style="margin-top: 0px">
								<img src="/images/phone-11.png" alt="">
							</div>
						</li>
					</ol>
				</div>
				<h4 class="sub-title"><strong class="line"><span class="text">일반 주유 시</span></strong></h4>
				<div class="service-list ty2">
					<ol>
						<li>
							<div class="service-number"><strong>01</strong></div>
							<div class="list-title"><strong class="type-3">주유원에게<br><span class="line"><span class="text">바로주유</span></span><br>결제 요청하기</strong></div>
							<div class="service-image">
								<img src="/images/phone-12.png" alt="">
							</div>
						</li>
						<li>
							<div class="service-number"><strong>02</strong></div>
							<div class="list-title"><strong class="type-2">에너지플러스 앱에서<br>바로주유 선택 후<br><span class="line"><span class="text">바코드 또는 주유코드</span></span> 보여주기</strong></div>
							<div class="service-image">
								<img src="/images/phone-13.png" alt="">
							</div>
						</li>
						<li>
							<div class="service-number"><strong>03</strong></div>
							<div class="list-title"><strong class="type-3">주유원이 이동식 단말기로<br>바코드 인식하기</span></span></strong></div>
							<div class="service-image">
								<img src="/images/phone-14.png" alt="">
							</div>
						</li>
						<li>
							<div class="service-number"><strong>04</strong></div>
							<div class="list-title"><strong class="type-3">주유하기</strong></div>
							<div class="service-image" style="margin-top: 31px;">
								<img src="/images/phone-15.png" alt="">
							</div>
						</li>
					</ol>
				</div>
				<div class="is-button-fixed bt">
					<div class="inner">
						<button id="layer-on" class="button is-dark is-fullwidth">바로주유 가능 주유소 확인하기</button>
					</div>
				</div>
			</div>
		</div>
		<!-- // Contents -->
	</div>

  <!-- 모달창 -->
	<div class="modal oil-search">
		<div class="modal-background"></div>

		 <!--  Bottom Sheet -->
		 <div class="bottom-sheet is-bottom-fixed">

			<div class="bottom-sheet-header">
				<h2 class="title is-3 has-text-centered">바로주유 가능 주유소</h2>
				<button id="layer-close" class="btn-close"><span class="blind">닫기</span></button>
			</div>

			<div class="bottom-sheet-body">
				<div class="inner">
					<div class="level">
						<div class="select is-medium level-left">
							<select name="sido"></select>
						</div>
						<div class="select is-medium level-right">
							<select name="gu"></select>
						</div>
					</div>
					<div class="item-list-box">
						<table>
							<caption>바로주유 가능 주유소 목록</caption>
							<colgroup>
								<col style="width:15%">
								<col style="width:50%">
								<col style="width:15%">
							</colgroup>

							<thead>
								<tr>
									<th scope="col">주유소명</th>
									<th scope="col">주소</th>
									<th scope="col">주유구분</th>
								</tr>
							</thead>
							<tbody id="item-list">
								<tr>
									<td>영통주유소</td>
									<td>셀프</td>
									<td>경기도 수원시 영통구 청명로 107 (영통동)
                  </td>
								</tr>
							</tbody>
						</table>
					</div>
          <!-- 2022 02.15 삭제 요청 -->
					<!-- <p class="dis">*바로주유 준비중 일정은 변경될 수 있습니다.</p> -->
				</div>
			</div>
		</div>
	</div>
	<!--모달창 끝  -->
</div>
<script>
  // 바로주유 가능 주유소 json 데이터 불러오기
let data = null;
let sidoPushArray = new Array;
let sidoArray = new Array;

const sido = document.querySelector('[name="sido"]');
const gu = document.querySelector('[name="gu"]');

let sidoSelected = null;
let guSelected = null;

fetch('/js/code.json', {
	method : 'GET'
})
.then(res => res.json())
.then(res => {
	data = res;
	data.forEach(item =>
		sidoPushArray.push(item.sido_name)
	);
	sidoPushArray.forEach((item) => {
		if (!sidoArray.includes(item)) {
			sidoArray.push(item);
		}
	});

	sidoArray.forEach((item, index) => {
		sido.insertAdjacentHTML('beforeend', `<option value="${item}">${item}</option>`);
	});

	sidoSelected = sido.options[sido.selectedIndex].value;
	guList(sidoSelected);
	selectedItem(sidoSelected, guSelected)

})
.catch(error => console.error(error));

const guList = (selected) => {
	let guArray = new Array;
	let guPushNameArray = new Array;

	while(gu.hasChildNodes()){
		gu.removeChild(gu.firstChild);
	}

	data.forEach((item, index) => {
		if(selected == item.sido_name){
			guPushNameArray.push(item.sigungu_name);
		}
	});
    

	guPushNameArray.forEach((item) => {
		if(!guArray.includes(item)){
			guArray.push(item);
		};
	});

	guArray.sort((a, b) => {
		if(b.sigungu_name > a.sigungu_name){
			return -1
		} else if(b.sigungu_name < a.sigungu_name){
			return 1
		} else {
			return 0
		}
	});

	guArray.forEach((item, index) => {
		gu.insertAdjacentHTML('beforeend', `<option value="${item}">${item}</option>`);	
	});

	guSelected = gu.options[gu.selectedIndex].value;
};

const selectedItem = (sido, gu) => {
	const itemList = document.querySelector('#item-list');
	while(itemList.hasChildNodes()){
		itemList.removeChild(itemList.firstChild);
	}
	data.forEach((item, index) => {
		if(sido == item.sido_name){
			if(gu == item.sigungu_name){
				let html = '';
					html += '<tr>';
					html += `	<td>${item.store_name}</td>`
					html += ` 	<td>${item.address}</td>`
					html += ` 	<td>${item.date}</td>`
					html += '</tr>';
				itemList.insertAdjacentHTML('beforeend', html);	
			}
		}
	});
};

sido.addEventListener('change', (e) =>{
	sidoSelected = sido.options[sido.selectedIndex].value;
	guSelected = gu.options[gu.selectedIndex].value;

	guList(sidoSelected);
	selectedItem(sidoSelected, guSelected);
});

gu.addEventListener('change', (e) =>{
	sidoSelected = sido.options[sido.selectedIndex].value;
	guSelected = gu.options[gu.selectedIndex].value;

	selectedItem(sidoSelected, guSelected);
});

document.getElementById('layer-on').addEventListener('click', () => {
	document.querySelector('.modal').classList.add('is-active');
});

document.getElementById('layer-close').addEventListener('click', () => {
	document.querySelector('.modal').classList.remove('is-active');
});
</script>
</body>
</html>